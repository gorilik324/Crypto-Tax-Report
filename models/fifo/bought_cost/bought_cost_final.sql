SELECT
    symbol,
    buy_order_id,
    buy_time,
    bought_time,
    bought_price,
    bought_qty,
    bought_cost,
    buy_fee,
    prev_buy_time,
    prev_bought_time,
    prev_buy_fee,
    prev_buy_order_id,
    prev_bought_price,
    prev_bought_qty,
    prev_bought_cost,
    follow_bought_qty,
    cum_prev_bought_qty,
    cum_sold_qty,
    cum_bought_qty,
    sold_time,
    sold_price,
    sell_fee,
    cum_prev_sold_qty,
    prev_sold_qty,
    sell_order_id,
    prev_sell_order_id,
    sold_datetime,
    sold_qty,
    proceeds,
    bcf
FROM
    {{ ref('bought_cost_f') }}
UNION
SELECT
    symbol,
    buy_order_id,
    buy_time,
    bought_time,
    bought_price,
    bought_qty,
    bought_cost,
    buy_fee,
    prev_buy_time,
    prev_bought_time,
    prev_buy_fee,
    prev_buy_order_id,
    prev_bought_price,
    prev_bought_qty,
    prev_bought_cost,
    follow_bought_qty,
    cum_prev_bought_qty,
    cum_sold_qty,
    cum_bought_qty,
    sold_time,
    sold_price,
    sell_fee,
    cum_prev_sold_qty,
    prev_sold_qty,
    sell_order_id,
    prev_sell_order_id,
    sold_datetime,
    sold_qty,
    proceeds,
    bcf
FROM
    {{ ref('fifo') }}
ORDER BY
    bought_time,
    sold_time
